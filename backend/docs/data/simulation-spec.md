# Simulation Specification: Enterprise-Grade Data

To avoid "toy data," the simulation engine uses a **Stateful Entity Model**. Events are not random; they are generated by simulating the behavior of persistent actors within a modeled organization.

## 1. Simulation Philosophy
- **Consistency**: A "User" (e.g., `alice_dev`) has consistent attributes (Role: Admin, MFA: True) across all events.
- **Causality**: A "CPU Spike" event is likely to be followed by an "Auto-Scaling" event.
- **Seasonality**: Traffic follows business hours (high M-F 9-5, low weekends/nights).

## 2. Modeled Entities
The simulator instantiates these objects at startup:

| Entity | Count | Examples |
|---|---|---|
| **Users** | 50+ | Developers, SREs, Finance Admins, "Bad Actors" |
| **Services** | 10+ | `payment-api`, `auth-service`, `frontend-web` |
| **Resources** | 100+ | EC2 Instances, S3 Buckets, Database Nodes |

## 3. Scenario Engines

### A. The "Shadow IT" Chain
1.  **Trigger**: User `dev_junior` (Role: Junior) attempts `sudo` on `db-prod`.
2.  **Context**: Time is `03:00 AM` (Seasonality override).
3.  **Result**: `SSH Login` -> `Command Exec` -> `No Change Request Found` -> **Incident**.

### B. The "Financial Drift" Chain
1.  **Baseline**: Generate 1000 normal transactions/hour ($10-$100).
2.  **Injection**: Introduce a bias factor of +1.5% to settlements.
3.  **Result**: Over 24 hours, the `settled_amount` drifts away from `initiated_amount`.
4.  **Behavior**: The `Anomaly Agent` detects the Z-score deviation after 4 hours.

### C. The "Cascading Failure" Chain (Chaos)
1.  **Trigger**: Inject `latency_ms = 5000` into `payment-api`.
2.  **Effect 1**: `HTTP 504` errors spike in weblogs.
3.  **Effect 2**: Retry logic causes `request_count` to double (Retry Storm).
4.  **Effect 3**: CPU on `api-nodes` hits 99%.
5.  **Effect 4**: Auto-scaler adds 10 instances (Cost Spike).

## 4. Implementation Strategy
We will use Python `faker` + a custom `WorldState` class.

```python
class WorldState:
    def __init__(self):
        self.users = self._generate_users(50)
        self.services = self._generate_services(10)
        self.active_incidents = []

    def tick(self):
        # Update time
        # Generate background noise (traffic)
        # Advance active scenarios
        pass
```
