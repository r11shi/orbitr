# ADR 002: Proactive Audit & Resolution Engine

## Status
Proposed

## Context
Standard audit logs are often passive and hard to parse. In a high-speed hackathon environment, we need audits that are actionable and "magic."

## Decision
We will implement an **Active Audit Agent** that pairs every detected event with a **Resolution Suggestion**.

- **Structure**: Each audit entry will contain the `correlation_id`, the full `WorkflowState`, and a `suggestion` block.
- **Resolution Suggestions**: The `Insight Synthesizer` will generate 1-3 specific CLI commands or API calls to resolve the issue.
- **Persistence**: We will use SQLite for the MVP, with a schema that supports "State Rewind" (viewing exactly what each agent thought at a specific point in time).

## Consequences

### Positive
- **Actionability**: Admins don't just see a problem; they see the fix.
- **Transparency**: Every agent's decision is traceable.
- **Demo Appeal**: Showing a "One-click fix" generated by the AI is a strong demo point.

### Negative
- **Storage Overhead**: Saving the full state for every step can grow quickly (mitigated by setting a TTL or limit for the MVP).

## Example Audit Entry (JSON representation)
```json
{
  "correlation_id": "8c2a-9f1b",
  "event_type": "ShadowDeployment",
  "flags": ["PolicyViolation", "SecretLeak"],
  "insight": "Critical: Direct push to main at 2AM contains AWS keys.",
  "suggestion": {
    "command": "git revert HEAD && aws iam deactivate-access-key --access-key-id AKIA...",
    "type": "immediate_action"
  }
}
```
